document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("courses-container"),d=document.getElementById("add-course"),w=document.getElementById("calculate"),i=document.getElementById("clear-all"),u=document.getElementById("save-data"),h=document.getElementById("results"),x=document.getElementById("cgpa-result");let A=1;const I=50,f=()=>{if(d&&r){const t=r.children.length>=I;d.disabled=t,d.title=t?"Maximum courses reached":""}},S=localStorage.getItem("iium-gpa-data");if(S)try{const e=JSON.parse(S);e.prevCgpa&&(document.getElementById("prev-cgpa").value=e.prevCgpa),e.prevCredits&&(document.getElementById("prev-credits").value=e.prevCredits)}catch{}if(f(),r&&r.children.length===1){const e=r.querySelector(".remove-btn");e&&(e.disabled=!0)}r?.addEventListener("keydown",e=>{if(e.key==="Enter"){const t=e.target,n=t.closest(".course-row");n&&(t.tagName==="INPUT"||t.tagName==="SELECT")&&(e.preventDefault(),n.nextElementSibling?n.nextElementSibling.querySelector(".course-name")?.focus():d.disabled||d?.click())}}),d?.addEventListener("click",()=>{const e=r?.children.length||0;if(e>=I)return;if(e===1){const n=r?.firstElementChild?.querySelector(".remove-btn");n&&(n.disabled=!1)}const t=document.createElement("div");t.className="course-row slide-in",t.dataset.index=A++,t.innerHTML=`
        <input type="text" class="course-name" placeholder="Course name" aria-label="Course name" maxlength="60" />
        <select class="grade" aria-label="Grade">
          <option value="">Grade</option>
          <option value="4.00">A (4.00)</option>
          <option value="3.67">A- (3.67)</option>
          <option value="3.33">B+ (3.33)</option>
          <option value="3.00">B (3.00)</option>
          <option value="2.67">B- (2.67)</option>
          <option value="2.33">C+ (2.33)</option>
          <option value="2.00">C (2.00)</option>
          <option value="1.67">C- (1.67)</option>
          <option value="1.33">D+ (1.33)</option>
          <option value="1.00">D (1.00)</option>
          <option value="0.00">F (0.00)</option>
        </select>
        <select class="credits" aria-label="Credits">
          <option value="">Credits</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
        </select>
        <button type="button" class="remove-btn" title="Remove course" aria-label="Remove course">×</button>
      `,r?.appendChild(t),f(),t.querySelector(".course-name")?.focus()}),r?.addEventListener("click",e=>{const t=e.target.closest(".remove-btn");if(t&&(r?.children.length||0)>1){const o=t.closest(".course-row");if(!o)return;const s=()=>{let v=o.nextElementSibling?.querySelector(".remove-btn");if(v||(v=o.previousElementSibling?.querySelector(".remove-btn")),o.remove(),r?.children.length===1){const p=r.firstElementChild?.querySelector(".remove-btn");p&&(p.disabled=!0)}v&&v.focus(),f()};window.matchMedia("(prefers-reduced-motion: reduce)").matches?s():(o.classList.add("removing"),setTimeout(s,200))}}),r?.addEventListener("input",e=>{const t=e.target;t.classList.contains("input-error")&&(t.classList.remove("input-error"),t.removeAttribute("aria-invalid")),document.getElementById("validation-error")?.classList.remove("visible")}),w?.addEventListener("click",()=>{const e=r?.children,t=document.getElementById("validation-error");t&&(t.textContent="",t.classList.remove("visible"));let n=!1,o=null,s=0,m=0;if(Array.from(e||[]).forEach(a=>{const C=a.querySelector(".course-name"),l=a.querySelector(".grade"),c=a.querySelector(".credits");[C,l,c].forEach(g=>{g?.classList.remove("input-error"),g?.removeAttribute("aria-invalid")});const T=C.value.trim()!=="",E=l.value!=="",b=c.value!=="";if((T||E||b)&&(!E||!b))n=!0,E||(l.classList.add("input-error"),l.setAttribute("aria-invalid","true"),o||(o=l)),b||(c.classList.add("input-error"),c.setAttribute("aria-invalid","true"),o||(o=c));else if(E&&b){const g=parseFloat(l.value),L=parseInt(c.value);!isNaN(g)&&!isNaN(L)&&(s+=g*L,m+=L)}}),n){t&&(t.textContent="⚠️ Please fill in Grade and Credits for all started courses.",t.classList.add("visible")),o&&(o.focus(),o.scrollIntoView({behavior:"smooth",block:"center"})),h?.classList.add("hidden"),x?.classList.add("hidden");const a=r?.querySelector(".input-error");a&&(a.focus(),a.scrollIntoView({behavior:"smooth",block:"center"}));return}const v=m>0?(s/m).toFixed(2):"0.00";document.getElementById("semester-gpa").textContent=v,document.getElementById("total-credits").textContent=m,h?.classList.remove("hidden");const p=parseFloat(document.getElementById("prev-cgpa").value),y=parseInt(document.getElementById("prev-credits").value);if(!isNaN(p)&&!isNaN(y)&&y>0){const C=p*y+s,l=y+m,c=(C/l).toFixed(2);document.getElementById("new-cgpa").textContent=c,x?.classList.remove("hidden")}});let B;i?.addEventListener("click",()=>{if(i.getAttribute("data-confirm")==="true"){const e=r?.children;e&&Array.from(e).forEach((t,n)=>{if(n>0)t.remove();else{t.querySelector(".course-name").value="",t.querySelector(".grade").value="",t.querySelector(".credits").value="",t.querySelector(".course-name").focus();const o=t.querySelector(".remove-btn");o&&(o.disabled=!0)}}),document.getElementById("prev-cgpa").value="",document.getElementById("prev-credits").value="",h?.classList.add("hidden"),x?.classList.add("hidden"),f(),i.textContent="Clear All",i.classList.remove("btn-danger-text"),i.removeAttribute("data-confirm"),clearTimeout(B)}else{const e=i.textContent;i.textContent="Confirm Clear?",i.classList.add("btn-danger-text"),i.setAttribute("data-confirm","true"),B=setTimeout(()=>{i.textContent=e,i.classList.remove("btn-danger-text"),i.removeAttribute("data-confirm")},3e3)}}),u?.addEventListener("click",()=>{const e=document.getElementById("prev-cgpa"),t=document.getElementById("prev-credits"),n=document.getElementById("save-status"),o={prevCgpa:e?.value||"",prevCredits:t?.value||""};localStorage.setItem("iium-gpa-data",JSON.stringify(o));const s=u.textContent;u.textContent="✅ Saved!",u.disabled=!0,n&&(n.textContent="Changes saved successfully",n.classList.add("visible")),setTimeout(()=>{u.textContent=s,u.disabled=!1,n&&(n.classList.remove("visible"),setTimeout(()=>{n.textContent=""},300))},2e3)}),document.querySelectorAll(".copy-btn").forEach(e=>{e.addEventListener("click",async()=>{const n=e.previousElementSibling?.textContent||"";try{await navigator.clipboard.writeText(n);const o=e.innerHTML;e.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>',e.classList.add("copied"),e.setAttribute("aria-label","Copied!"),setTimeout(()=>{e.innerHTML=o,e.classList.remove("copied"),e.setAttribute("aria-label","Copy to clipboard")},2e3)}catch(o){console.error("Failed to copy:",o)}})})});
//# sourceMappingURL=GPACalculator.astro_astro_type_script_index_0_lang.1cAObJ45.js.map
